<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>filterCommonSuffixes.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>List</span>

<span class='hs-comment'>-- | Filter a word list, removing those words that are duplicates apart from common suffixes.  |</span>
<span class='hs-comment'>-- | Reads SORTED list on stdin, emits filtered list on stdout.</span>
<span class='hs-definition'>main</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span><span class='hs-conid'>()</span>
<span class='hs-definition'>main</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
  <span class='hs-varid'>allInput</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getContents</span>
  <span class='hs-varid'>putStrLn</span> <span class='hs-layout'>(</span><span class='hs-str'>"Got "</span> <span class='hs-varop'>++</span> <span class='hs-layout'>(</span><span class='hs-varid'>show</span> <span class='hs-layout'>(</span><span class='hs-varid'>myLength</span> <span class='hs-layout'>(</span><span class='hs-varid'>lines</span> <span class='hs-varid'>allInput</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>++</span> <span class='hs-str'>" lines"</span><span class='hs-layout'>)</span>
  <span class='hs-varid'>putStrLn</span> <span class='hs-layout'>(</span><span class='hs-str'>"Suffixes are:\n\t"</span> <span class='hs-varop'>++</span> <span class='hs-layout'>(</span><span class='hs-varid'>concat</span> <span class='hs-layout'>(</span><span class='hs-varid'>intersperse</span> <span class='hs-str'>"\n\t"</span> <span class='hs-varid'>suffixes</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
  <span class='hs-varid'>putStrLn</span> <span class='hs-layout'>(</span><span class='hs-str'>"suffixes is a list of length "</span> <span class='hs-varop'>++</span> <span class='hs-layout'>(</span><span class='hs-varid'>show</span> <span class='hs-layout'>(</span><span class='hs-varid'>myLength</span> <span class='hs-varid'>suffixes</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
  <span class='hs-varid'>putStrLn</span> <span class='hs-layout'>(</span><span class='hs-str'>"Filtered list has "</span> <span class='hs-varop'>++</span> <span class='hs-layout'>(</span><span class='hs-varid'>show</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-layout'>(</span><span class='hs-varid'>filterSuffixes</span> <span class='hs-layout'>(</span><span class='hs-varid'>lines</span> <span class='hs-varid'>allInput</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>++</span> <span class='hs-str'>" words."</span><span class='hs-layout'>)</span>
  <span class='hs-varid'>putStrLn</span> <span class='hs-str'>"Words:"</span>
  <span class='hs-varid'>putStrLn</span> <span class='hs-layout'>(</span><span class='hs-varid'>concat</span> <span class='hs-layout'>(</span><span class='hs-varid'>intersperse</span> <span class='hs-str'>"\n"</span> <span class='hs-layout'>(</span><span class='hs-varid'>filterSuffixes</span> <span class='hs-layout'>(</span><span class='hs-varid'>lines</span> <span class='hs-varid'>allInput</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
  <span class='hs-varid'>putStrLn</span> <span class='hs-str'>"Done."</span>

<span class='hs-comment'>-- | The common suffixes we will be removing</span>
<span class='hs-definition'>suffixes</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Char</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span>
<span class='hs-definition'>suffixes</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-str'>"s"</span><span class='hs-layout'>,</span><span class='hs-str'>"es"</span><span class='hs-layout'>,</span><span class='hs-str'>"ed"</span><span class='hs-layout'>,</span><span class='hs-str'>"ing"</span><span class='hs-layout'>,</span><span class='hs-str'>"ly"</span><span class='hs-keyglyph'>]</span> 

<span class='hs-comment'>-- | Just a stupid length function to show that we can use pure functions on something bound with</span>
<span class='hs-comment'>-- | the "&lt;-" operator.</span>
<span class='hs-definition'>myLength</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<span class='hs-definition'>myLength</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>0</span>
<span class='hs-definition'>myLength</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>myLength</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span>

<span class='hs-comment'>-- | The actual filter function. Removes words that are like prefix apart from common suffix.</span>
<span class='hs-definition'>filterSuffixes</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Char</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>Char</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span>
<span class='hs-definition'>filterSuffixes</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<span class='hs-definition'>filterSuffixes</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>lastword</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>lastword</span><span class='hs-keyglyph'>]</span>
<span class='hs-definition'>filterSuffixes</span> <span class='hs-layout'>(</span><span class='hs-varid'>prefix</span> <span class='hs-conop'>:</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>lastword</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
  <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-varid'>hasSuffix</span> <span class='hs-varid'>prefix</span> <span class='hs-varid'>lastword</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>prefix</span><span class='hs-keyglyph'>]</span>
  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>                    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>prefix</span> <span class='hs-conop'>:</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>lastword</span><span class='hs-keyglyph'>]</span>
<span class='hs-definition'>filterSuffixes</span> <span class='hs-layout'>(</span><span class='hs-varid'>prefix</span> <span class='hs-conop'>:</span> <span class='hs-varid'>nextword</span> <span class='hs-conop'>:</span> <span class='hs-varid'>restwords</span><span class='hs-layout'>)</span>
  <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-varid'>hasSuffix</span> <span class='hs-varid'>prefix</span> <span class='hs-varid'>nextword</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>filterSuffixes</span> <span class='hs-layout'>(</span><span class='hs-varid'>prefix</span> <span class='hs-conop'>:</span> <span class='hs-varid'>restwords</span><span class='hs-layout'>)</span>
  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>                    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>prefix</span> <span class='hs-conop'>:</span> <span class='hs-layout'>(</span><span class='hs-varid'>filterSuffixes</span> <span class='hs-layout'>(</span><span class='hs-varid'>nextword</span> <span class='hs-conop'>:</span> <span class='hs-varid'>restwords</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>

<span class='hs-comment'>-- | Returns true if the given word appends one of the common suffixes to the given prefix.</span>
<span class='hs-definition'>hasSuffix</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Char</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Char</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class='hs-definition'>hasSuffix</span> <span class='hs-varid'>prefix</span> <span class='hs-varid'>word</span> 
  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isPrefix</span> <span class='hs-varid'>prefix</span> <span class='hs-varid'>word</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>elem</span> <span class='hs-layout'>(</span><span class='hs-varid'>drop</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>prefix</span><span class='hs-layout'>)</span> <span class='hs-varid'>word</span><span class='hs-layout'>)</span> <span class='hs-varid'>suffixes</span>
  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>              <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>

<span class='hs-comment'>-- | Returns true if the given prefix is actually a prefix of the given word</span>
<span class='hs-definition'>isPrefix</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Char</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Char</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class='hs-definition'>isPrefix</span> <span class='hs-varid'>prefix</span> <span class='hs-varid'>word</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>take</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>prefix</span><span class='hs-layout'>)</span> <span class='hs-varid'>word</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-varid'>prefix</span>
</pre></body>
</html>
